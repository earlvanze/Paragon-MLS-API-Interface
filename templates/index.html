<head>
        <title>Rental Property Cash Flow Analysis</title>
		<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css" integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">
</head>
<body>
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark fixed-top">
	  <a class="navbar-brand" href="#">Rental Property Cash Flow Analysis</a>
	  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo02" aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">
	    <span class="navbar-toggler-icon"></span>
	  </button>
	
	  <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
	    <ul class="navbar-nav mr-auto mt-2 mt-lg-0">
	      <li class="nav-item active">
	        <a class="nav-link" href="#">Home <span class="sr-only">(current)</span></a>
	      </li>
	      <li class="nav-item">
	        <a class="nav-link" href="/app">Login</a>
	      </li>
  	      <li class="nav-item">
	        <a class="nav-link" href="https://docs.google.com/spreadsheets/d/1S-Vqsw_JyrCo6_zziWM_llZNl8AU92MeLZx9Xp5lMyw/copy">Spreadsheet</a>
	      </li>
	    </ul>
	    <form class="form-inline my-2 my-lg-0">
	      <input class="form-control mr-sm-2" type="search" placeholder="Search">
	      <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
	    </form>
	  </div>
	</nav>

	<div class="container" style="padding:100px">
		<div class="row justify-content-md-center">
			<div class="col col-8" style="center overflow:hidden">
			<section>
				<article class="markdown-body entry-content" itemprop="text"><h1><a id="user-content-paragon-real-estate-multiple-listing-service-api-interface" class="anchor" aria-hidden="true" href="#paragon-real-estate-multiple-listing-service-api-interface"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Paragon Real Estate Multiple Listing Service API Interface</h1>
				<h3><a id="user-content-for-automated-four-square-analysis-of-rental-properties" class="anchor" aria-hidden="true" href="#for-automated-four-square-analysis-of-rental-properties"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>For Automated Four-Square Analysis of Rental Properties</h3>
				<p>This program takes in an ID from a Paragonrels.com or fnimls.com URL and automatically populates your own copy of this
				<a href="https://docs.google.com/spreadsheets/d/1S-Vqsw_JyrCo6_zziWM_llZNl8AU92MeLZx9Xp5lMyw/copy" rel="nofollow"><b>Google Spreadsheet</b></a>
				in order to calculate Cash Flow and Cash-on-Cash Return for investment properties. No coding experience necessary.</p>
				<p>Row 2 of the spreadsheet has formulas that automatically populate with calculations for each new row.
				I recommend leaving these formulas in place.</p>
				<p>This spreadsheet was derived from the PDF available at
				<a href="https://www.biggerpockets.com/renewsblog/easily-analyzing-rental-properties-four-square-method/" rel="nofollow">BiggerPockets.com</a></p>
				<p>You can try out a live demo of the program at <a href="https://rentals.mymealtor.com/app" rel="nofollow">
				<b></b></a><b><a href="https://rentals.mymealtor.com/app" rel="nofollow">https://rentals.mymealtor.com/app</a></b>. Go to the Google Sheet and click File &gt; Make a Copy if it doesn't ask you to copy automatically.
				Make your own copy of the Google spreadsheet linked above and copy your own Google Sheet's ID
				(derived from the URL <a href="https://docs.google.com/spreadsheets/d/%7BSPREADSHEET_ID%7D" rel="nofollow">https://docs.google.com/spreadsheets/d/{SPREADSHEET_ID}</a>) to the Google Sheet ID box on the form. The only required fields are the Google Sheet ID in the field at the bottom, and the MLS number(s) pasted in the big text box.</p>
				<p>I've tested this with globalmls, imls, hudson, gamls, and triangle regions/system IDs I found on Twitter.
				Other *.paragonrels.com regions may or may not work out of the box. Change the System ID accordingly.</p>
				<p>You should have an agent send you a listing from your region's MLS in order to get the GUID ("MLS ID") from the URL,
				which is used to pull the listings in that ID, but this is not necessary.</p>
				<p>Alternatively, if you know your local MLS System ID, you can pass that in along with a text file
				containing a list of MLS numbers you're interested in analyzing.
				The System ID is usually the subdomain of *.paragonrels.com or *.fnimls.com but this may be different for your region.
				Given only the System ID and the MLS number, the Paragon API can return the listing's information.</p>
				<p>However, each MLS system is slightly different in the formatting of their listings
				(and sometimes, listings within the same MLS system are different from each other)
				and thus, the json result from the get_properties() function is formatted differently and parses slightly differently.
				If you encounter errors in parsing the json even though the json files are properly created in the "listings" folder,
				you may need to adjust the parse_json() code inside the nested try-except blocks to fit your listings'
				general format so it can be parsed properly.</p>
				<h2><a id="user-content-prerequisites-for-running-the-app-on-your-desktop" class="anchor" aria-hidden="true" href="#prerequisites-for-running-the-app-on-your-desktop"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Prerequisites for running the app on your desktop</h2>
				<p>From <a href="https://developers.google.com/sheets/api/quickstart/python" rel="nofollow">https://developers.google.com/sheets/api/quickstart/python</a></p>
				<p>To run this program, you'll need:</p>
				<p>Python 2.6 or greater.</p>
				<p>This was developed and tested using Python 3.6.4 on macOS High Sierra
				but it should work in any other Python environment as long as the necessary Python modules are installed.
				If Python complains that one of the modules is missing, just install that module and let me know that this
				documentation is missing a package.</p>
				<p>The <a href="https://pypi.python.org/pypi/pip" rel="nofollow">pip</a> package management tool.</p>
				<p>A Google account.</p>
				<p>Clone this repository using git in Terminal (Mac or Linux) by typing:</p>
				<pre><code>git clone https://github.com/earlvanze/Paragon-MLS-API-Interface paragon &amp;&amp; cd paragon
				</code></pre>
				<p>Windows users need to install git or GitHub Desktop or simply download the repository as a zip and unzip the package.</p>
				<h2><a id="user-content-step-1-turn-on-the-google-sheets-api" class="anchor" aria-hidden="true" href="#step-1-turn-on-the-google-sheets-api"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Step 1: Turn on the Google Sheets API</h2>
				<p>Use <a href="https://console.developers.google.com/start/api?id=sheets.googleapis.com" rel="nofollow">this wizard</a> to create or
				select a project in the Google Developers Console and automatically turn on the API.</p>
				<p>Click Continue, then Go to credentials.</p>
				<p>On the Add credentials to your project page, click the Cancel button.</p>
				<p>At the top of the page, select the OAuth consent screen tab.</p>
				<p>Select an Email address, enter a Product name if not already set, and click the Save button.</p>
				<p>Select the Credentials tab, click the Create credentials button and select OAuth client ID.</p>
				<p>Select the application type Other, enter the name "Google Sheets API Quickstart", and click the Create button.</p>
				<p>Click OK to dismiss the resulting dialog.</p>
				<p>Click the file_download (Download JSON) button to the right of the client ID.</p>
				<p>Move this file to your working directory and rename it client_secret.json.</p>
				<h2><a id="user-content-step-2-install-the-google-client-library-and-other-non-standard-python-modules" class="anchor" aria-hidden="true" href="#step-2-install-the-google-client-library-and-other-non-standard-python-modules"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Step 2: Install the Google Client Library and other non-standard python modules</h2>
				<p>Run the following command in Terminal to install the necessary libraries using pip:</p>
				<pre><code>pip install --upgrade pandas httplib2 google-api-python-client oauth2client<br>pip install -r requirements.txt
				</code></pre>
				<p>See the library's <a href="https://developers.google.com/api-client-library/python/start/installation" rel="nofollow">installation page</a> for the alternative installation options.</p>
				<h2><a id="user-content-step-3-make-a-copy-of-spreadsheet-and-update-mainpy" class="anchor" aria-hidden="true" href="#step-3-make-a-copy-of-spreadsheet-and-update-mainpy"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Step 3: Make a copy of spreadsheet and update main.py</h2>
				<p>Make your own copy of the Google spreadsheet linked above and replace GSHEET_ID
				with your own Google Sheet's ID (derived from the URL <a href="https://docs.google.com/spreadsheets/d/%7BSPREADSHEET_ID%7D" rel="nofollow">https://docs.google.com/spreadsheets/d/{SPREADSHEET_ID}</a>)</p>
				<p>You can also pass this in as a command-line argument to override the default global variable one time</p>
				<p>If you renamed the specific sheet 'Four-Square Analysis!A:AX' inside the Google Sheets file or modified the number of columns,
				replace RANGE_NAME with the new name along with the new range of columns.</p>
				<p>Note that if you modify the number of columns, you may also want to modify the columns list in save_csv() to match.
				Or not, since the save_csv() function does not affect the append_to_gsheet() function.</p>
				<p>What is important is that if you want to save a csv of the listings, the number of columns in the output_data list
				returned by get_properties() and passed in to save_csv() MUST match the number of items in columns[], or Python will throw an exception.</p>
				<p>Example: 'Four-Square Analysis!A:AX'</p>
				<h2><a id="user-content-step-4-run-the-program" class="anchor" aria-hidden="true" href="#step-4-run-the-program"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Step 4: Run the program</h2>
				<p>Run the sample using the following command [optional flags]</p>
				<pre><code>python main.py -i 'guid/id from URL of MLS listings from broker/agent' \
				-l 'filename for newline-separated list of MLS #s' -f 'temporary_folder_for_listings' -s 'MLS System ID/subdomain' -g 'Google Sheets ID'
				</code></pre>
				<p>The append_to_gsheet() code will attempt to open a new window or tab in your default browser. If this fails, copy the URL from the console and manually open it in your browser.</p>
				<p>If you are not already logged into your Google account, you will be prompted to log in.
				If you are logged into multiple Google accounts, you will be asked to select one account to use for the authorization.</p>
				<p>Click the Accept button.
				The sample will proceed automatically, and you may close the window/tab.</p>
				<p>If you need help, type:</p>
				<pre><code>python main.py --help
				</code></pre>
				<h2><a id="user-content-how-did-i-figure-all-this-out" class="anchor" aria-hidden="true" href="#how-did-i-figure-all-this-out"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How did I figure all this out?</h2>
				<p>This is the "normal" desktop/legacy version of the Paragon MLS, usually provided by your real estate broker/agent.
				http://{system_id}.paragonrels.com/publink/default.aspx?GUID={mls_id}</p>
				<p>I was originally going to use the legacy version's request URL:
				<a href="http:/globalmls.paragonrels.com/publink/Report.aspx?&amp;GUID=%7Bmls_id%7D&amp;ListingID=%7Bmls_number%7D:0&amp;layout_id=3" rel="nofollow">http://globalmls.paragonrels.com/publink/Report.aspx?&amp;GUID={mls_id}&amp;ListingID={mls_number}:0&amp;layout_id=3</a>
				and scrape the output HTML, but why do scraping when a perfectly good public API is available?</p>
				<p>In the upper left corner, there is a button to "Switch to Mobile View", a nicer, cleaner, mobile-friendly, responsive UI that leads to:
				http://{system_id}.paragonrels.com/CollabLink/#/?id={mls_id}</p>
				<p>By using Chrome's <i>Inspect Element</i> &gt; <i>Network</i> feature, I found out about the API
				and proceeded to spend an entire weekend to essentially reverse-engineer how it works.
				By understanding the public CollabLink API with little to no public documentation, I could theoretically create my own Zillow or StreetEasy.
				But that's beyond the scope of this git repo.</p>
				<p>Relevant reading: <a href="https://blog.hartleybrody.com/web-scraping/" rel="nofollow">https://blog.hartleybrody.com/web-scraping/</a>, I found after the fact.</p>
				<p>Enjoy!</p>
				<h2><a id="user-content-donate" class="anchor" aria-hidden="true" href="#donate"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Donate</h2>
				<p>If you like this program, please donate using any of the methods below!</p>
				<p>Square Cash	<a href="http://cash.me/$digitalkid" rel="nofollow">http://cash.me/$digitalkid</a></p>
				<p>Venmo	<a href="https://venmo.com/earlco" rel="nofollow">https://venmo.com/earlco</a></p>
				<p>PayPal	<a href="http://paypal.me/earlco" rel="nofollow">http://paypal.me/earlco</a></p>
				<p>Zelle	<a href="mailto:earlvanze@gmail.com">earlvanze@gmail.com</a></p>
				<p>BTC	12icq2NfvXDYExaH3a4FVnWJwerb1oj31Z</p>
				<p>ETH	0x234AD7D3225dC28f2B292cCBE05CdD321C4aCC5B</p>
				<p>ZEC	t1duLU96HyXQ7dGwdesZB6C4iCPe5HZw5ar</p>
				<p>LTC	LQymEUqGK9dBeugi2bNNtt4LEGpm6bMYjJ</p>
				<p>NEO/GAS	ALfeqEsmEexzk5RFGUZinedMAtjnfUz4f7</p>
				<p>SC	de1caac41616a762428a2c2baca667bde5fb27ff6b0717bb0d2c1b3493a3f972933524ef9d19</p>
				<p>If you want me to build a version for YOUR region, please reach out by email: <a href="mailto:earlvanze@gmail.com">earlvanze@gmail.com</a></p>
				</article>
			</section>
			</div>
		</div>
	</div>
</body>
<footer class="page-footer font-small footer-dark bg-dark text-light">
	<div class="footer-copyright text-center py-3" style="padding-top: 60px">© 2018 
		<a href="https://mymealtor.com">Mealtor Inc.</a> | <a href="https://mymealtor.com/contact.html">Contact Us</a> | <a href="https://mymealtor.com/privacy-policy.html">Privacy Policy</a>
	</div>
</footer>